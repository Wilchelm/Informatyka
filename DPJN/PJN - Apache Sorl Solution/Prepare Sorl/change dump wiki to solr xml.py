#!/usr/bin/python3
# -*- coding: utf-8 -*-

import sys, csv, numpy, pandas, time, string, re
from pathlib import Path

start_time = time.time()

Path("./Dane/00linijki.txt").touch()
linijki = open("./Dane/00linijki.txt","w")
s = open("../plwiki-latest-pages-articles1.xml-p2p169750","r")
suma = 0
plik = 0
linijki.write("plwiki... start at "+str(plik)+".txt file\n")
Path("./Dane/"+str(plik)+".xml").touch()
w = open("./Dane/"+str(plik)+".xml","w")
w.write("<add>\n")
for line in s.readlines():	
	line = re.sub(r'<redirect title=.*', '', line)	
	line = re.sub(r'<ip>.*', '', line)	
	line = re.sub(r'<page>', '<doc>', line)
	line = re.sub(r'<title>', '<field name = "title">', line)
	line = re.sub(r'</title>', '</field>', line)
	line = re.sub(r'<ns>', '<field name = "ns">', line)
	line = re.sub(r'</ns>', '</field>', line)
	line = re.sub(r'[ ]*<revision>','',line)
	line = re.sub(r'</revision>','',line)
	line = re.sub(r'^    <id>', '    <field name = "id">', line)
	line = re.sub(r'</id>', '</field>', line)
	line = re.sub(r'<parentid>', '<field name = "parentid">', line)
	line = re.sub(r'</parentid>', '</field>', line)
	line = re.sub(r'<timestamp>', '<field name = "timestamp">', line)
	line = re.sub(r'</timestamp>', '</field>', line)
	line = re.sub(r'^        <id>.*', '', line)
	line = re.sub(r'^      <id>.*','',line)
	line = re.sub(r'<contributor>','',line)
	line = re.sub(r'<minor />','',line)
	line = re.sub(r'</contributor>','',line)
	line = re.sub(r'<username>.*','',line)
	line = re.sub(r'<comment>', '<field name = "comment">', line)
	line = re.sub(r'</comment>', '</field>', line)
	line = re.sub(r'<model>', '<field name = "model">', line)
	line = re.sub(r'</model>', '</field>', line)
	line = re.sub(r'<format>', '<field name = "format">', line)
	line = re.sub(r'</format>', '</field>', line)
	line = re.sub(r'<text xml:space="preserve">', '<field name = "text">', line)
	line = re.sub(r'</text>', '</field>', line)
	line = re.sub(r'<sha1>', '<field name = "sha1">', line)
	line = re.sub(r'</sha1>', '</field>', line)
	line = re.sub(r'</page>', '</doc>', line)
	w.write(line)
	if (bool(re.search(r'</doc>', line))==True):
		suma = suma + 1
	if(suma > 10):
		w.write("</add>")
		w.close()
		suma = 0
		plik = plik + 1
		Path("./Dane/"+str(plik)+".xml").touch()
		w = open("./Dane/"+str(plik)+".xml","w")
		w.write("<add>\n")
s.close()
print ("Done! "+str(plik))
linijki.write("plwiki... start at "+str(plik)+".txt file\n")
print (time.time() - start_time)


s = open("../plwiki-latest-pages-articles2.xml-p169751p510662","r")
for line in s.readlines():	
	line = re.sub(r'<redirect title=.*', '', line)		
	line = re.sub(r'<ip>.*', '', line)
	line = re.sub(r'<page>', '<doc>', line)
	line = re.sub(r'<title>', '<field name = "title">', line)
	line = re.sub(r'</title>', '</field>', line)
	line = re.sub(r'<ns>', '<field name = "ns">', line)
	line = re.sub(r'</ns>', '</field>', line)
	line = re.sub(r'[ ]*<revision>','',line)
	line = re.sub(r'</revision>','',line)
	line = re.sub(r'^    <id>', '    <field name = "id">', line)
	line = re.sub(r'</id>', '</field>', line)
	line = re.sub(r'<parentid>', '<field name = "parentid">', line)
	line = re.sub(r'</parentid>', '</field>', line)
	line = re.sub(r'<timestamp>', '<field name = "timestamp">', line)
	line = re.sub(r'</timestamp>', '</field>', line)
	line = re.sub(r'^        <id>.*', '', line)
	line = re.sub(r'^      <id>.*','',line)
	line = re.sub(r'<contributor>','',line)
	line = re.sub(r'<minor />','',line)
	line = re.sub(r'</contributor>','',line)
	line = re.sub(r'<username>.*','',line)
	line = re.sub(r'<comment>', '<field name = "comment">', line)
	line = re.sub(r'</comment>', '</field>', line)
	line = re.sub(r'<model>', '<field name = "model">', line)
	line = re.sub(r'</model>', '</field>', line)
	line = re.sub(r'<format>', '<field name = "format">', line)
	line = re.sub(r'</format>', '</field>', line)
	line = re.sub(r'<text xml:space="preserve">', '<field name = "text">', line)
	line = re.sub(r'</text>', '</field>', line)
	line = re.sub(r'<sha1>', '<field name = "sha1">', line)
	line = re.sub(r'</sha1>', '</field>', line)
	line = re.sub(r'</page>', '</doc>', line)
	w.write(line)
	if (bool(re.search(r'</doc>', line))==True):
		suma = suma + 1
	if(suma > 10):
		w.write("</add>")
		w.close()
		suma = 0
		plik = plik + 1
		Path("./Dane/"+str(plik)+".xml").touch()
		w = open("./Dane/"+str(plik)+".xml","w")
		w.write("<add>\n")
s.close()
print ("Done! "+str(plik))
linijki.write("plwiki... start at "+str(plik)+".txt file\n")
print (time.time() - start_time)


s = open("../plwiki-latest-pages-articles3.xml-p510663p1056310","r")
for line in s.readlines():	
	line = re.sub(r'<redirect title=.*', '', line)		
	line = re.sub(r'<ip>.*', '', line)
	line = re.sub(r'<page>', '<doc>', line)
	line = re.sub(r'<title>', '<field name = "title">', line)
	line = re.sub(r'</title>', '</field>', line)
	line = re.sub(r'<ns>', '<field name = "ns">', line)
	line = re.sub(r'</ns>', '</field>', line)
	line = re.sub(r'[ ]*<revision>','',line)
	line = re.sub(r'</revision>','',line)
	line = re.sub(r'^    <id>', '    <field name = "id">', line)
	line = re.sub(r'</id>', '</field>', line)
	line = re.sub(r'<parentid>', '<field name = "parentid">', line)
	line = re.sub(r'</parentid>', '</field>', line)
	line = re.sub(r'<timestamp>', '<field name = "timestamp">', line)
	line = re.sub(r'</timestamp>', '</field>', line)
	line = re.sub(r'^        <id>.*', '', line)
	line = re.sub(r'^      <id>.*','',line)
	line = re.sub(r'<contributor>','',line)
	line = re.sub(r'<minor />','',line)
	line = re.sub(r'</contributor>','',line)
	line = re.sub(r'<username>.*','',line)
	line = re.sub(r'<comment>', '<field name = "comment">', line)
	line = re.sub(r'</comment>', '</field>', line)
	line = re.sub(r'<model>', '<field name = "model">', line)
	line = re.sub(r'</model>', '</field>', line)
	line = re.sub(r'<format>', '<field name = "format">', line)
	line = re.sub(r'</format>', '</field>', line)
	line = re.sub(r'<text xml:space="preserve">', '<field name = "text">', line)
	line = re.sub(r'</text>', '</field>', line)
	line = re.sub(r'<sha1>', '<field name = "sha1">', line)
	line = re.sub(r'</sha1>', '</field>', line)
	line = re.sub(r'</page>', '</doc>', line)
	w.write(line)
	if (bool(re.search(r'</doc>', line))==True):
		suma = suma + 1
	if(suma > 10):
		w.write("</add>")
		w.close()
		suma = 0
		plik = plik + 1
		Path("./Dane/"+str(plik)+".xml").touch()
		w = open("./Dane/"+str(plik)+".xml","w")
		w.write("<add>\n")
s.close()
print ("Done! "+str(plik))
linijki.write("plwiki... start at "+str(plik)+".txt file\n")
print (time.time() - start_time)


s = open("../plwiki-latest-pages-articles4.xml-p1056311p1831508","r")
for line in s.readlines():	
	line = re.sub(r'<redirect title=.*', '', line)		
	line = re.sub(r'<ip>.*', '', line)
	line = re.sub(r'<page>', '<doc>', line)
	line = re.sub(r'<title>', '<field name = "title">', line)
	line = re.sub(r'</title>', '</field>', line)
	line = re.sub(r'<ns>', '<field name = "ns">', line)
	line = re.sub(r'</ns>', '</field>', line)
	line = re.sub(r'[ ]*<revision>','',line)
	line = re.sub(r'</revision>','',line)
	line = re.sub(r'^    <id>', '    <field name = "id">', line)
	line = re.sub(r'</id>', '</field>', line)
	line = re.sub(r'<parentid>', '<field name = "parentid">', line)
	line = re.sub(r'</parentid>', '</field>', line)
	line = re.sub(r'<timestamp>', '<field name = "timestamp">', line)
	line = re.sub(r'</timestamp>', '</field>', line)
	line = re.sub(r'^        <id>.*', '', line)
	line = re.sub(r'^      <id>.*','',line)
	line = re.sub(r'<contributor>','',line)
	line = re.sub(r'<minor />','',line)
	line = re.sub(r'</contributor>','',line)
	line = re.sub(r'<username>.*','',line)
	line = re.sub(r'<comment>', '<field name = "comment">', line)
	line = re.sub(r'</comment>', '</field>', line)
	line = re.sub(r'<model>', '<field name = "model">', line)
	line = re.sub(r'</model>', '</field>', line)
	line = re.sub(r'<format>', '<field name = "format">', line)
	line = re.sub(r'</format>', '</field>', line)
	line = re.sub(r'<text xml:space="preserve">', '<field name = "text">', line)
	line = re.sub(r'</text>', '</field>', line)
	line = re.sub(r'<sha1>', '<field name = "sha1">', line)
	line = re.sub(r'</sha1>', '</field>', line)
	line = re.sub(r'</page>', '</doc>', line)
	w.write(line)
	if (bool(re.search(r'</doc>', line))==True):
		suma = suma + 1
	if(suma > 10):
		w.write("</add>")
		w.close()
		suma = 0
		plik = plik + 1
		Path("./Dane/"+str(plik)+".xml").touch()
		w = open("./Dane/"+str(plik)+".xml","w")
		w.write("<add>\n")
s.close()
print ("Done! "+str(plik))
linijki.write("plwiki... start at "+str(plik)+".txt file\n")
print (time.time() - start_time)


s = open("../plwiki-latest-pages-articles5.xml-p1831509p3070392","r")
for line in s.readlines():	
	line = re.sub(r'<redirect title=.*', '', line)		
	line = re.sub(r'<ip>.*', '', line)
	line = re.sub(r'<page>', '<doc>', line)
	line = re.sub(r'<title>', '<field name = "title">', line)
	line = re.sub(r'</title>', '</field>', line)
	line = re.sub(r'<ns>', '<field name = "ns">', line)
	line = re.sub(r'</ns>', '</field>', line)
	line = re.sub(r'[ ]*<revision>','',line)
	line = re.sub(r'</revision>','',line)
	line = re.sub(r'^    <id>', '    <field name = "id">', line)
	line = re.sub(r'</id>', '</field>', line)
	line = re.sub(r'<parentid>', '<field name = "parentid">', line)
	line = re.sub(r'</parentid>', '</field>', line)
	line = re.sub(r'<timestamp>', '<field name = "timestamp">', line)
	line = re.sub(r'</timestamp>', '</field>', line)
	line = re.sub(r'^        <id>.*', '', line)
	line = re.sub(r'^      <id>.*','',line)
	line = re.sub(r'<contributor>','',line)
	line = re.sub(r'<minor />','',line)
	line = re.sub(r'</contributor>','',line)
	line = re.sub(r'<username>.*','',line)
	line = re.sub(r'<comment>', '<field name = "comment">', line)
	line = re.sub(r'</comment>', '</field>', line)
	line = re.sub(r'<model>', '<field name = "model">', line)
	line = re.sub(r'</model>', '</field>', line)
	line = re.sub(r'<format>', '<field name = "format">', line)
	line = re.sub(r'</format>', '</field>', line)
	line = re.sub(r'<text xml:space="preserve">', '<field name = "text">', line)
	line = re.sub(r'</text>', '</field>', line)
	line = re.sub(r'<sha1>', '<field name = "sha1">', line)
	line = re.sub(r'</sha1>', '</field>', line)
	line = re.sub(r'</page>', '</doc>', line)
	w.write(line)
	if (bool(re.search(r'</doc>', line))==True):
		suma = suma + 1
	if(suma > 10):
		w.write("</add>")
		w.close()
		suma = 0
		plik = plik + 1
		Path("./Dane/"+str(plik)+".xml").touch()
		w = open("./Dane/"+str(plik)+".xml","w")
		w.write("<add>\n")
s.close()
print ("Done! "+str(plik))
linijki.write("plwiki... start at "+str(plik)+".txt file\n")
print (time.time() - start_time)


s = open("../plwiki-latest-pages-articles6.xml-p3070395p4494802","r")
for line in s.readlines():	
	line = re.sub(r'<redirect title=.*', '', line)
	line = re.sub(r'<ip>.*', '', line)	
	line = re.sub(r'<page>', '<doc>', line)
	line = re.sub(r'<title>', '<field name = "title">', line)
	line = re.sub(r'</title>', '</field>', line)
	line = re.sub(r'<ns>', '<field name = "ns">', line)
	line = re.sub(r'</ns>', '</field>', line)
	line = re.sub(r'[ ]*<revision>','',line)
	line = re.sub(r'</revision>','',line)
	line = re.sub(r'^    <id>', '    <field name = "id">', line)
	line = re.sub(r'</id>', '</field>', line)
	line = re.sub(r'<parentid>', '<field name = "parentid">', line)
	line = re.sub(r'</parentid>', '</field>', line)
	line = re.sub(r'<timestamp>', '<field name = "timestamp">', line)
	line = re.sub(r'</timestamp>', '</field>', line)
	line = re.sub(r'^        <id>.*', '', line)
	line = re.sub(r'^      <id>.*','',line)
	line = re.sub(r'<contributor>','',line)
	line = re.sub(r'<minor />','',line)
	line = re.sub(r'</contributor>','',line)
	line = re.sub(r'<username>.*','',line)
	line = re.sub(r'<comment>', '<field name = "comment">', line)
	line = re.sub(r'</comment>', '</field>', line)
	line = re.sub(r'<model>', '<field name = "model">', line)
	line = re.sub(r'</model>', '</field>', line)
	line = re.sub(r'<format>', '<field name = "format">', line)
	line = re.sub(r'</format>', '</field>', line)
	line = re.sub(r'<text xml:space="preserve">', '<field name = "text">', line)
	line = re.sub(r'</text>', '</field>', line)
	line = re.sub(r'<sha1>', '<field name = "sha1">', line)
	line = re.sub(r'</sha1>', '</field>', line)
	line = re.sub(r'</page>', '</doc>', line)
	w.write(line)
	if (bool(re.search(r'</doc>', line))==True):
		suma = suma + 1
	if(suma > 10):
		w.write("</add>")
		w.close()
		suma = 0
		plik = plik + 1
		Path("./Dane/"+str(plik)+".xml").touch()
		w = open("./Dane/"+str(plik)+".xml","w")
		w.write("<add>\n")
s.close()
print ("Done! "+str(plik))
linijki.write("plwiki... start at "+str(plik)+".txt file\n")
print (time.time() - start_time)

w.write("</add>")
w.close()
linijki.close()

print (time.time() - start_time)


